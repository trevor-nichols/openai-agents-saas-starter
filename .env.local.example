# Copy this file to .env.local and replace every secret before running in production.

# -----------------------------------------------------------------------------
# Core application (required everywhere)
# -----------------------------------------------------------------------------
ENVIRONMENT=development
DEBUG=true
PORT=8000
APP_PUBLIC_URL=http://localhost:3000
ALLOWED_HOSTS=localhost,localhost:8000,127.0.0.1,testserver,testclient
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# -----------------------------------------------------------------------------
# Secrets (must be unique per environment before production)
# -----------------------------------------------------------------------------
SECRET_KEY=change-me
AUTH_PASSWORD_PEPPER=change-me-too
AUTH_REFRESH_TOKEN_PEPPER=change-me-again
AUTH_EMAIL_VERIFICATION_TOKEN_PEPPER=change-me-email
AUTH_PASSWORD_RESET_TOKEN_PEPPER=change-me-reset
# Required for encrypted session metadata in production
AUTH_SESSION_ENCRYPTION_KEY=
# Optional salt (defaults to SECRET_KEY when empty)
AUTH_SESSION_IP_HASH_SALT=

# -----------------------------------------------------------------------------
# Database / Redis (required)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/anything_agents
REDIS_URL=redis://localhost:6379/0
# Optional dedicated Redis for billing events (falls back to REDIS_URL when blank)
BILLING_EVENTS_REDIS_URL=
RATE_LIMIT_KEY_PREFIX=rate-limit
# Automatically run migrations on startup (dev convenience only)
AUTO_RUN_MIGRATIONS=false

# -----------------------------------------------------------------------------
# Rate limits (tune per-environment; defaults safe for dev)
# -----------------------------------------------------------------------------
CHAT_RATE_LIMIT_PER_MINUTE=60
CHAT_STREAM_RATE_LIMIT_PER_MINUTE=30
CHAT_STREAM_CONCURRENT_LIMIT=5
BILLING_STREAM_RATE_LIMIT_PER_MINUTE=20
BILLING_STREAM_CONCURRENT_LIMIT=3
PASSWORD_RESET_TOKEN_TTL_MINUTES=30
PASSWORD_RESET_EMAIL_RATE_LIMIT_PER_HOUR=5
PASSWORD_RESET_IP_RATE_LIMIT_PER_HOUR=20
EMAIL_VERIFICATION_TOKEN_TTL_MINUTES=60
EMAIL_VERIFICATION_EMAIL_RATE_LIMIT_PER_HOUR=3
EMAIL_VERIFICATION_IP_RATE_LIMIT_PER_HOUR=10

# -----------------------------------------------------------------------------
# Authentication policies (set before production)
# -----------------------------------------------------------------------------
REQUIRE_EMAIL_VERIFICATION=true
AUTH_PASSWORD_HISTORY_COUNT=5
AUTH_REFRESH_TOKEN_TTL_MINUTES=43200
AUTH_LOCKOUT_THRESHOLD=5
AUTH_LOCKOUT_WINDOW_MINUTES=60
AUTH_LOCKOUT_DURATION_MINUTES=60
AUTH_IP_LOCKOUT_THRESHOLD=50
AUTH_IP_LOCKOUT_WINDOW_MINUTES=10
AUTH_IP_LOCKOUT_DURATION_MINUTES=10
AUTH_JWKS_CACHE_SECONDS=300
AUTH_JWKS_MAX_AGE_SECONDS=300
AUTH_JWKS_ETAG_SALT=local-jwks-salt

# -----------------------------------------------------------------------------
# Tenant defaults & signup policies
# -----------------------------------------------------------------------------
TENANT_DEFAULT_SLUG=default
ALLOW_PUBLIC_SIGNUP=true
ALLOW_SIGNUP_TRIAL_OVERRIDE=false
SIGNUP_RATE_LIMIT_PER_HOUR=20
SIGNUP_DEFAULT_PLAN_CODE=starter
SIGNUP_DEFAULT_TRIAL_DAYS=14

# -----------------------------------------------------------------------------
# Billing (optional; required when ENABLE_BILLING=true)
# -----------------------------------------------------------------------------
ENABLE_BILLING=false
ENABLE_BILLING_STREAM=false
ENABLE_BILLING_RETRY_WORKER=true
ENABLE_BILLING_STREAM_REPLAY=true
BILLING_RETRY_DEPLOYMENT_MODE=inline
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRODUCT_PRICE_MAP={"starter":"price_xxx"}

# -----------------------------------------------------------------------------
# AI Providers (set at least one before deploying agents)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
GEMINI_API_KEY=
XAI_API_KEY=
TAVILY_API_KEY=

# -----------------------------------------------------------------------------
# Email (Resend)
# -----------------------------------------------------------------------------
RESEND_EMAIL_ENABLED=false
RESEND_BASE_URL=https://api.resend.com
RESEND_API_KEY=
RESEND_DEFAULT_FROM=
RESEND_EMAIL_VERIFICATION_TEMPLATE_ID=
RESEND_PASSWORD_RESET_TEMPLATE_ID=

# -----------------------------------------------------------------------------
# Observability & GeoIP
# -----------------------------------------------------------------------------
LOGGING_SINK=stdout
LOGGING_DATADOG_API_KEY=
LOGGING_DATADOG_SITE=datadoghq.com
LOGGING_OTLP_ENDPOINT=
LOGGING_OTLP_HEADERS=
GEOIP_PROVIDER=none
GEOIP_MAXMIND_LICENSE_KEY=
GEOIP_IP2LOCATION_API_KEY=

# -----------------------------------------------------------------------------
# Vault Transit (optional locally, required when vault_verify_enabled=true)
# -----------------------------------------------------------------------------
VAULT_VERIFY_ENABLED=false
VAULT_ADDR=
VAULT_TOKEN=
VAULT_TRANSIT_KEY=auth-service
